# 📄 Technical Whitepaper: Riduck Cycling Simulator (Core Physics & Physiology)

본 문서는 Riduck Cycling Simulator에 적용된 물리 해석 엔진의 공학적 설계 구조와 라이더 생리 모델의 상세 연산 과정을 기술합니다. GPX 경로 데이터를 기반으로 현실적인 주행 퍼포먼스를 재현하기 위해 적용된 수치 해석 및 가변 파워 제어 기법을 중점적으로 다룹니다.

---

## 🏗 1. Physics Engine: Bisection Integration (이분 탐색 적분 모델)

시뮬레이터의 핵심은 각 구간별 속도($v$)를 찾아내는 것입니다. 기존의 단순 반복법이 가진 수치적 불안정성을 해결하기 위해 **이분 탐색(Bisection Method)** 기반의 에너지 평형 해석법을 고안했습니다.

### 1.1 일-에너지 정리 기반의 목적 함수
본 엔진은 시간($t$)이 아닌 거리($d$)를 독립 변수로 취급합니다. 각 구간($\Delta d$)의 종단 속도($v_{next}$)는 에너지 보존 법칙을 만족해야 합니다.

$$ \frac{1}{2}m v_{next}^2 = \frac{1}{2}m v_{curr}^2 + \int_{0}^{\Delta d} (F_{pedal} - F_{resist}) \, dx $$

여기서 수치해석적 정밀도를 위해 구간 알짜힘($F_{net}$)을 다음과 같이 정의하고, 이 잔차가 0이 되는 $v_{next}$를 탐색합니다.

$$ f(v_{next}) = \Delta KE - Work_{net} = 0 $$

### 1.2 수치적 수렴 (Numerical Convergence)
자전거 주행 물리에서 가장 까다로운 부분은 $F_{pedal} = P / v$ 항입니다. 속도가 0에 가까워지면 힘이 무한대로 발산하여 계산이 터지는 특이점(Singularity)이 발생합니다.

*   **이분 탐색 적용:** $0.01$ m/s ~ $40.0$ m/s 사이의 범위를 30회 반복 분할하여 해를 찾습니다.
*   **안정성 확보:** 매 루프마다 중간값($Mid$) 속도로 저항력을 재계산하여 에너지가 남는지 모자라는지를 판별합니다. 이 방식은 기울기가 급격한 저속 구간에서도 진동 없이 $10^{-9}$ 수준의 정밀한 수렴을 보장합니다.
*   **보정 장치 제거:** 이분 탐색의 수학적 견고함 덕분에 Relaxation(가중 평균)이나 인위적인 토크 캡(Force Cap) 없이 순수 물리 수식만으로 모든 지형(0~25% 경사)을 완벽하게 해석합니다.

---

## 🧠 2. Physiological Modeling (생리학적 모델링)

라이더가 낼 수 있는 파워는 지속 시간에 따라 비선형적으로 변합니다. 이를 모사하기 위해 **PDC(Power Duration Curve)**와 **Riegel의 피로 지수**를 결합한 하이브리드 제어 로직을 적용했습니다.

### 2.1 Dynamic Power Blending (동적 파워 결합)
코스 전체의 예상 소요 시간($T_{est}$)에 따라 라이더의 파워 한계($P_{limit}$)를 결정합니다.

1.  **가중치 함수 ($\alpha$):** 
    *   $T \le 20\text{min}$: $\alpha = 1.0$ (단거리 모드) 
    *   $T \ge 120\text{min}$: $\alpha = 0.0$ (장거리 모드)
    *   그 사이 구간: 지수 감쇠($\alpha = \text{decay}(T)$)를 통한 부드러운 전환.
2.  **한계 파워 산출:**
    $$ P_{limit} = \alpha \cdot P_{PDC}(T) + (1 - \alpha) \cdot P_{CP} \cdot (T/60)^{-0.07} $$
    *   이를 통해 **북악(10분)**에서는 사용자의 PDC 데이터(예: 390W)를 100% 인출하고, **설악(8시간)**에서는 CP 기반의 안정적인 페이스로 자동 전환됩니다.

### 2.2 W' Balance (무산소 에너지 활용)
라이더의 한계 역치(CP)를 초과하는 주행 시 발생하는 에너지 소모와 회복을 실시간으로 추적합니다.
*   **소모:** $P > CP$ 일 때 초당 $(P - CP)$ 주울(J)만큼 차감.
*   **전략:** 시뮬레이터의 Solver는 구간 끝에서 $W'$ 잔량이 0에 수렴할 때까지 $P_{base}$를 높여가는 **최적 페이싱(Optimal Pacing)** 전략을 구사합니다.

---

## ⚙️ 3. Environmental & Mechanical Factors

### 3.1 코너링 물리 (Cornering Braking)
경로의 기하학적 특성이 평속에 미치는 영향을 반영합니다.
*   **곡률 계산:** 세그먼트 간의 방위각 변화량($\Delta \theta$)과 거리($L$)를 통해 회전 반경($R$)을 도출합니다.
*   **안전 속도 제약:** $V_{limit} = \sqrt{\mu \cdot g \cdot R}$ ($\mu=0.8$)
    커브 진입 시 현재 속도가 $V_{limit}$보다 빠르면 강제로 브레이크를 잡아 에너지를 소멸시킵니다. 이는 다운힐 헤어핀 구간에서의 현실적인 감속을 구현합니다.

### 3.2 시스템 무게와 저항 파라미터
*   **System Mass:** 라이더 체중 + 자전거 무게 + 장비 가중치(Attack 1kg, Fondo 4kg)를 엄격히 분리하여 오르막 저항($mg\sin\theta$)을 계산합니다.
*   **Rolling Resistance:** 노면 상태(Crr 0.005~0.007)와 공기저항(CdA 0.38~0.45)을 라이더 프로필 및 주행 시나리오에 맞춰 정밀하게 설정합니다.

---

## 🎯 4. 결론 (Summary of Methodology)

본 시뮬레이터는 **"수학적으로 완벽하게 수렴하는 물리 코어(Bisection)"** 위에 **"인간의 파워 지속 능력을 반영한 생리 레이어(PDC Blending)"**를 얹어 설계되었습니다.

인위적인 데이터 보정을 최소화하고, 순수 뉴턴 역학과 실측 파워 데이터를 연동함으로써 북악(7분 46초 실측)과 설악(8시간 초반 예상) 등 상이한 성격의 코스 모두에서 신뢰할 수 있는 시뮬레이션 환경을 구축했습니다.
