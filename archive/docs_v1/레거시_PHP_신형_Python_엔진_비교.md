# ğŸš´ ë ˆê±°ì‹œ(PHP) vs ì‹ í˜•(Python) ì‹œë®¬ë ˆì´í„° ìƒì„¸ ë¹„êµ ë¶„ì„

ë³¸ ë¬¸ì„œëŠ” ê¸°ì¡´ ì„œë¹„ìŠ¤ì— ì‚¬ìš©ë˜ë˜ PHP ê¸°ë°˜ ì‹œë®¬ë ˆì´í„°(`get-simulation.php`)ì™€ í˜„ì¬ ìƒˆë¡œ ê°œë°œëœ Python ë¬¼ë¦¬ ì—”ì§„(`src/physics_engine.py`)ì˜ ë¬¼ë¦¬ì , ê³µí•™ì  ì°¨ì´ë¥¼ ìƒì„¸íˆ ê¸°ìˆ í•©ë‹ˆë‹¤.

---

## 1. íŒ¨ëŸ¬ë‹¤ì„ì˜ ë³€í™”

| êµ¬ë¶„ | ë ˆê±°ì‹œ (PHP) | ì‹ í˜• (Python) |
| :--- | :--- | :--- |
| **ì •ì˜** | **ê³„ì‚°ê¸° (Calculator)** | **ì‹œë®¬ë ˆì´í„° (Simulator)** |
| **ëª©ì ** | ì…ë ¥ëœ í‰ê·  ì†ë„/íŒŒì›Œì— ëŒ€í•œ ë‹¨ìˆœ ë³€í™˜ | ì‹¤ì œ ì½”ìŠ¤ ì£¼í–‰ ì‹œ ë°œìƒí•˜ëŠ” ë¬¼ë¦¬ í˜„ìƒ ì¬í˜„ |
| **í•µì‹¬ ì§ˆë¬¸** | "í‰ê·  200Wë¥¼ ë‚´ë©´ í‰ì† ëª‡ km/hì¸ê°€?" | "ì´ ì½”ìŠ¤ì—ì„œ 250Wë¡œ ì¶œë°œí•˜ì—¬ ì²´ë ¥ì„ ì¡°ì ˆí•˜ë©´ ì™„ì£¼ ê°€ëŠ¥í•œê°€?" |

---

## 2. ë¬¼ë¦¬ ì—”ì§„ (Physics Engine) ìƒì„¸ ë¹„êµ

### A. ë ˆê±°ì‹œ (PHP): ì¢…ë‹¨ ì†ë„ í‰í˜• (Steady-State Equilibrium)
PHP ë²„ì „ì€ **ê´€ì„±(Inertia)**ê³¼ **ê°€ì†(Acceleration)**ì„ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¼ì´ë”ê°€ í•´ë‹¹ êµ¬ê°„ì—ì„œ ì¦‰ì‹œ ë“±ì† ìš´ë™ì„ í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.

*   **ì ìš© ê³µì‹**: Newton-Raphson ìˆ˜ì¹˜í•´ì„
    $$ f(v) = v \cdot (F_{aero} + F_{rolling} + F_{gravity}) - (\eta \cdot P) = 0 $$
    *   $F_{aero} = 0.5 \cdot \rho \cdot C_d A \cdot v^2$
    *   $F_{rolling} = m \cdot g \cdot C_{rr}$
    *   $F_{gravity} = m \cdot g \cdot \sin(\theta)$
    *   $\eta$: êµ¬ë™ê³„ íš¨ìœ¨ (Drivetrain Efficiency)

*   **ì‘ë™ ì›ë¦¬**:
    *   í˜„ì¬ì˜ íŒŒì›Œ($P$)ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ëª¨ë“  ì €í•­($F$)ì„ ì´ê²¨ë‚´ê³  ë‚¼ ìˆ˜ ìˆëŠ” **'ìµœì¢… ì†ë„(Terminal Velocity)'**ë¥¼ êµ¬í•©ë‹ˆë‹¤.
    *   **í•œê³„**: ë‚´ë¦¬ë§‰ì—ì„œ ê°€ì†ëœ ì†ë„ê°€ ì˜¤ë¥´ë§‰ ì´ˆì…ìœ¼ë¡œ ì´ì–´ì§€ëŠ” **'íƒ„ë ¥ ì£¼í–‰'**ì„ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### B. ì‹ í˜• (Python): ì—ë„ˆì§€ ë³´ì¡´ ë²•ì¹™ (Energy Balance)
Python ë²„ì „ì€ **ìš´ë™ ì—ë„ˆì§€(Kinetic Energy)**ì˜ ë³€í™”ë¥¼ ì¶”ì í•©ë‹ˆë‹¤. ì´ì „ êµ¬ê°„ì˜ ì†ë„ê°€ ë‹¤ìŒ êµ¬ê°„ì˜ ì´ˆê¸° ì†ë„ê°€ ë©ë‹ˆë‹¤.

*   **ì ìš© ê³µì‹**: ì¼-ì—ë„ˆì§€ ì •ë¦¬ (Work-Energy Theorem)
    $$ \Delta K.E. = W_{net} $$
    $$ \frac{1}{2}m v_{final}^2 - \frac{1}{2}m v_{initial}^2 = (F_{pedal} - F_{resistance}) \cdot d $$

*   **ì‘ë™ ì›ë¦¬**:
    *   êµ¬ê°„ ê±°ë¦¬($d$) ë™ì•ˆ ì•Œì§œí˜($F_{net}$)ì´ í•œ ì¼ë§Œí¼ ìš´ë™ ì—ë„ˆì§€ê°€ ë³€í•©ë‹ˆë‹¤.
    *   **ì¥ì **: ë‚´ë¦¬ë§‰ì—ì„œ ì–»ì€ ìš´ë™ ì—ë„ˆì§€ê°€ ì˜¤ë¥´ë§‰ ì§„ì… ì‹œ ì†ë„ë¥¼ ìœ ì§€ì‹œì¼œì£¼ëŠ” **ê´€ì„± íš¨ê³¼**ê°€ ë¬¼ë¦¬ì ìœ¼ë¡œ ì •í™•íˆ êµ¬í˜„ë©ë‹ˆë‹¤.
    *   **íŠ¹ìˆ˜ ê¸°ëŠ¥**: ì½”ë„ˆë§ ë¬¼ë¦¬ ($V_{limit} = \sqrt{\mu g R}$) ì ìš©ìœ¼ë¡œ ê¸‰ì»¤ë¸Œ ê°ì† ë°˜ì˜.

---

## 3. ë¼ì´ë” ìƒë¦¬í•™ì  ëª¨ë¸ (Physiology)

### A. ë ˆê±°ì‹œ (PHP): ë‹¨ìˆœ ì¡°íšŒ (Lookup)
*   ì‚¬ìš©ìì˜ FTPì™€ W/kgë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì €ì¥ëœ **íŒŒì›Œ ì»¤ë¸Œ í…Œì´ë¸”**ì„ ë‹¨ìˆœíˆ ì¡°íšŒí•©ë‹ˆë‹¤.
*   "ì´ ì‚¬ëŒì€ 20ë¶„ ë™ì•ˆ 250Wë¥¼ ë‚¼ ìˆ˜ ìˆë‹¤"ëŠ” í†µê³„ì  ì‚¬ì‹¤ë§Œ í™•ì¸í•˜ë©°, ì£¼í–‰ ì¤‘ í”¼ë¡œ ëˆ„ì ì´ë‚˜ íšŒë³µ ë©”ì»¤ë‹ˆì¦˜ì€ ì—†ìŠµë‹ˆë‹¤.

### B. ì‹ í˜• (Python): CP + W' ëª¨ë¸ (Skiba Model)
*   **CP (Critical Power)**ì™€ **W' (Anaerobic Work Capacity)** ê°œë…ì„ ë„ì…í•œ ë™ì  ëª¨ë¸ì…ë‹ˆë‹¤.
    *   **ê³ ê°ˆ**: $P > CP$ ì¼ ë•Œ, $W'$ ë°°í„°ë¦¬ê°€ ì´ˆë‹¹ $(P - CP)$ J ë§Œí¼ ì†Œëª¨ë©ë‹ˆë‹¤.
    *   **íšŒë³µ**: $P < CP$ ì¼ ë•Œ, $W'$ ë°°í„°ë¦¬ê°€ ì§€ìˆ˜ í•¨ìˆ˜ì (Exponential)ìœ¼ë¡œ íšŒë³µë©ë‹ˆë‹¤.
    *   **ë´‰í¬(Bonk)**: $W'$ ì”ëŸ‰ì´ 0 ì´í•˜ë¡œ ë–¨ì–´ì§€ë©´ ì£¼í–‰ ì‹¤íŒ¨ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.
*   **í† í¬ ê°ì‡ **: ì¥ì‹œê°„ ì£¼í–‰ ì‹œ ê·¼í”¼ë¡œë„ë¡œ ì¸í•´ ë‚¼ ìˆ˜ ìˆëŠ” ìµœëŒ€ í† í¬ê°€ ì ì§„ì ìœ¼ë¡œ ê°ì†Œí•©ë‹ˆë‹¤.

---

## 4. í˜ì´ì‹± ì „ëµ (Pacing Strategy)

| êµ¬ë¶„ | ë ˆê±°ì‹œ (PHP) | ì‹ í˜• (Python) |
| :--- | :--- | :--- |
| **ì „ëµ** | **ê³ ì • íŒŒì›Œ (Iso-Power)** | **ê°€ë³€ íŒŒì›Œ (Variable Pacing)** |
| **ë°©ì‹** | ì „ì²´ ì½”ìŠ¤ë¥¼ ë™ì¼í•œ íŒŒì›Œ/ì†ë„ë¡œ ì£¼í–‰í•œë‹¤ê³  ê°€ì • | ê²½ì‚¬ë„ì— ë”°ë¼ íŒŒì›Œë¥¼ ìµœì í™” (ì˜¤ë¥´ë§‰ $\uparrow$, ë‚´ë¦¬ë§‰ $\downarrow$) |
| **ìµœì í™”** | ì—†ìŒ (ì‚¬ìš©ì ì…ë ¥ê°’ ì˜ì¡´) | **Solver (ì´ë¶„ íƒìƒ‰)**ê°€ ì™„ì£¼ ê°€ëŠ¥í•œ ìµœëŒ€ íŒŒì›Œë¥¼ ìë™ìœ¼ë¡œ íƒìƒ‰ |

---

## 5. ì¥ë¹„ ë° í™˜ê²½ ë³€ìˆ˜ ë””í…Œì¼

### ë ˆê±°ì‹œ (PHP)ì˜ ê°•ì 
*   **êµ¬ë™ê³„ ë°ì´í„°ë² ì´ìŠ¤**: Shimano(DuraAce, Ultegra...), SRAM, Campagnolo ë“± ë¸Œëœë“œ/ë“±ê¸‰ë³„ êµ¬ë™ê³„ íš¨ìœ¨ì´ í•˜ë“œì½”ë”©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
    *   ì˜ˆ: `DuraAce (96.3%)` vs `105 (96.1%)`
*   íŠ¹ì • ë¶€í’ˆ ì—…ê·¸ë ˆì´ë“œì— ë”°ë¥¸ ë¯¸ì„¸í•œ ê¸°ë¡ ë‹¨ì¶• í™•ì¸ ìš©ë„ì— ì í•©í–ˆìŠµë‹ˆë‹¤.

### ì‹ í˜• (Python)ì˜ ê°•ì 
*   **ì¼ë°˜í™”ëœ ë¬¼ë¦¬ ë³€ìˆ˜**: íŠ¹ì • ë¸Œëœë“œ ëŒ€ì‹  `drivetrain_loss` (ì˜ˆ: 3~5%)ì™€ ê°™ì€ ë¬¼ë¦¬ì  ìˆ˜ì¹˜ë¥¼ ì§ì ‘ ì œì–´í•©ë‹ˆë‹¤.
*   **í™˜ê²½ ìƒí˜¸ì‘ìš©**: ì½”ë„ˆë§ ë°˜ê²½(Radius) ê³„ì‚°, ì´ˆ ë‹¨ìœ„ ë°”ëŒ(Wind) ë²¡í„° ì ìš© ë“± ê±°ì‹œì ì¸ ì£¼í–‰ í™˜ê²½ ìƒí˜¸ì‘ìš©ì— ì§‘ì¤‘í•©ë‹ˆë‹¤.

---

## 6. ìš”ì•½

| íŠ¹ì§• | ë ˆê±°ì‹œ (PHP) | ì‹ í˜• (Python) |
| :--- | :--- | :--- |
| **ì—”ì§„ íƒ€ì…** | ì •ì  ê³„ì‚°ê¸° | ë™ì  ì‹œë®¬ë ˆì´í„° |
| **ìˆ˜í•™ì  ê¸°ë°˜** | Newton-Raphson (ìˆ˜ë ´) | Energy Balance (ì ë¶„) |
| **ê´€ì„± ì£¼í–‰** | ë¶ˆê°€ëŠ¥ (Stop & Go) | **ê°€ëŠ¥ (ì‹¤ì œ ì£¼í–‰ê°)** |
| **ì²´ë ¥ ëª¨ë¸** | í†µê³„ (Table Lookup) | ìƒë¦¬ (CP + W' Bal) |
| **í™œìš© ë¶„ì•¼** | ë¶€í’ˆ ë³€ê²½ íš¨ê³¼ ë¶„ì„ | **ëŒ€íšŒ ì „ëµ ìˆ˜ë¦½, ì»·ì˜¤í”„ ì˜ˆì¸¡** |

---

## ğŸ›  Appendix: Core Logic Comparison

### [Legacy] PHP/Python v1.0 (ë°©ì •ì‹ ìˆ˜ë ´ ë°©ì‹)
ë”± ê·¸ ì§€ì ì—ì„œì˜ í˜ì˜ í‰í˜•($f(v)=0$)ì„ ë§Œì¡±í•˜ëŠ” ë‹¨ì¼ ì†ë„ë¥¼ ì°¾ìŠµë‹ˆë‹¤. (ê°€ì†ë„/ê´€ì„± ì—†ìŒ)

```python
def newton(aero, headwind, tres, transv, power):
    vel = 20.0  # ì´ˆê¸° ì¶”ì •ê°’ (m/s)
    for _ in range(10):  # ìµœëŒ€ 10ë²ˆ ë°˜ë³µí•˜ì—¬ ìˆ˜ë ´ì‹œí‚´
        tv = vel + headwind
        aero_eff = aero if tv > 0.0 else -aero
        # f(v) = íŒŒì›Œ - ì €í•­ = 0 ì´ ë˜ëŠ” ì§€ì  ì°¾ê¸°
        f = vel * (aero_eff * tv * tv + tres) - transv * power
        # fp(v) = f(v)ì˜ ë¯¸ë¶„ê°’
        fp = aero_eff * (3.0 * vel + headwind) * tv + tres
        
        v_new = vel - f / fp  # ë‰´í„´-ë©ìŠ¨ ê³µì‹
        if abs(v_new - vel) < 0.05: return v_new
        vel = v_new
    return vel
```

### [Current] Python v2.0 (ì—ë„ˆì§€ ë³´ì¡´ ë°©ì‹)
ì´ì „ êµ¬ê°„ì˜ ì†ë„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, ì—ë„ˆì§€ê°€ ë”í•´ì§€ê³  ë¹ ì§„ í›„ì˜ 'ë³€í™”ëœ ì†ë„'ë¥¼ ì°¾ìŠµë‹ˆë‹¤.

```python
def _solve_segment_physics(self, seg, power, v_entry, d_sub):
    # 1. ì´ˆê¸° ìƒíƒœ ì—ë„ˆì§€ í™•ì¸
    ke_initial = 0.5 * total_mass * (v_entry ** 2)
    
    # 2. ì´ë¶„ íƒìƒ‰(Bisection)ìœ¼ë¡œ ì—ë„ˆì§€ í‰í˜• ì†ë„(v_next) ì°¾ê¸°
    low, high = 0.01, 40.0
    for _ in range(30):
        mid = (low + high) / 2
        v_avg = (v_entry + mid) / 2
        
        # í˜(Force) ê³„ì‚°
        f_pedal = power / v_avg
        f_drag = 0.5 * rho * cda * (v_avg ** 2)
        f_net = f_pedal - f_drag - f_gravity - f_roll
        
        # ì¼-ì—ë„ˆì§€ ì •ë¦¬: (Net Force * ê±°ë¦¬) = ì—ë„ˆì§€ ë³€í™”ëŸ‰
        work_net = f_net * d_sub
        ke_final_required = 0.5 * total_mass * (mid ** 2)
        
        # ë‚¨ì€ ì—ë„ˆì§€ê°€ ëª©í‘œ ì†ë„ ì—ë„ˆì§€ë³´ë‹¤ í¬ë©´ ì†ë„ ì˜¬ë¦¼
        if ke_initial + work_net > ke_final_required:
            low = mid
        else:
            high = mid
            
    return (low + high) / 2  # ìµœì¢… ì†ë„ ë°˜í™˜
```
$!{after}